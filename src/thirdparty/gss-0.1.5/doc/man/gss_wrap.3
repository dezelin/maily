.\" DO NOT MODIFY THIS FILE!  It was generated by gdoc.
.TH "gss_wrap" 3 "0.1.5" "gss" "gss"
.SH NAME
gss_wrap \- API function
.SH SYNOPSIS
.B #include <gss.h>
.sp
.BI "OM_uint32 gss_wrap(OM_uint32 * " minor_status ", const gss_ctx_id_t " context_handle ", int " conf_req_flag ", gss_qop_t " qop_req ", const gss_buffer_t " input_message_buffer ", int * " conf_state ", gss_buffer_t " output_message_buffer ");"
.SH ARGUMENTS
.IP "OM_uint32 * minor_status" 12
(Integer, modify) Mechanism specific status code.
.IP "const gss_ctx_id_t context_handle" 12
(gss_ctx_id_t, read) Identifies the context on
  which the message will be sent.
.IP "int conf_req_flag" 12
(boolean, read) Non\-zero \- Both confidentiality and
  integrity services are requested. Zero \- Only integrity service is
  requested.
.IP "gss_qop_t qop_req" 12
(gss_qop_t, read, optional) Specifies required quality of
  protection.  A mechanism\-specific default may be requested by
  setting qop_req to GSS_C_QOP_DEFAULT.  If an unsupported
  protection strength is requested, gss_wrap will return a
  major_status of GSS_S_BAD_QOP.
.IP "const gss_buffer_t input_message_buffer" 12
(buffer, opaque, read) Message to be
  protected.
.IP "int * conf_state" 12
(boolean, modify, optional) Non\-zero \-
  Confidentiality, data origin authentication and integrity
  services have been applied. Zero \- Integrity and data origin
  services only has been applied.  Specify NULL if not required.
.IP "gss_buffer_t output_message_buffer" 12
(buffer, opaque, modify) Buffer to receive
  protected message.  Storage associated with this message must be
  freed by the application after use with a call to
  \fBgss_release_buffer()\fP.
.SH "DESCRIPTION"
Attaches a cryptographic MIC and optionally encrypts the specified
input_message.  The output_message contains both the MIC and the
message.  The qop_req parameter allows a choice between several
cryptographic algorithms, if supported by the chosen mechanism.

Since some application\-level protocols may wish to use tokens
emitted by \fBgss_wrap()\fP to provide "secure framing", implementations
must support the wrapping of zero\-length messages.
.SH "RETURN VALUE"

`GSS_S_COMPLETE`: Successful completion.

`GSS_S_CONTEXT_EXPIRED`: The context has already expired.

`GSS_S_NO_CONTEXT`: The context_handle parameter did not identify a
 valid context.

`GSS_S_BAD_QOP`: The specified QOP is not supported by the
mechanism.
.SH "REPORTING BUGS"
Report bugs to <bug-gss@gnu.org>.
GNU Generic Security Service home page: http://www.gnu.org/software/gss/
General help using GNU software: http://www.gnu.org/gethelp/
.SH COPYRIGHT
Copyright \(co 2003-2010 Simon Josefsson.
.br
Copying and distribution of this file, with or without modification,
are permitted in any medium without royalty provided the copyright
notice and this notice are preserved.
.SH "SEE ALSO"
The full documentation for
.B gss
is maintained as a Texinfo manual.  If the
.B info
and
.B gss
programs are properly installed at your site, the command
.IP
.B info gss
.PP
should give you access to the complete manual.
